<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset="utf-8"/>
    <title>IRInstructionMapper</title>
        <link rel="stylesheet" type="text/css" href="../../clang-doc-mustache.css"/>
        <script src="../../mustache-index.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/default.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/cpp.min.js"></script>
</head>
<body>
    <nav class="navbar">
        <div class="navbar__container">
            <div class="navbar__logo">
                
            </div>
            <div class="navbar__menu">
                <ul class="navbar__links">
                    <li class="navbar__item">
                        <a href="../../index.html" class="navbar__link">Home</a>
                    </li>
                </ul>
            </div>
            <div class="navbar-breadcrumb-container">
                <div class="navbar-breadcrumb-item"><a href="../../GlobalNamespace/index.html">Global Namespace</a></div>&rarr;
                <div class="navbar-breadcrumb-item"><a href="../index.html">llvm</a></div>&rarr;
                <div class="navbar-breadcrumb-item"><a href="./index.html">IRSimilarity</a></div>
            </div>
        </div>
    </nav>
    <main>
        <div class="container">
            <div class="sidebar">
                <h2>struct IRInstructionMapper</h2>
                <ul>
                    <li class="sidebar-section">
                        <a class="sidebar-item" href="#PublicMembers">Public Members</a>
                    </li>
                    <li>
                        <ul>
                            <li class="sidebar-item-container">
                                <a class="sidebar-item" href="#IllegalInstrNumber">IllegalInstrNumber</a>
                            </li>
                            <li class="sidebar-item-container">
                                <a class="sidebar-item" href="#LegalInstrNumber">LegalInstrNumber</a>
                            </li>
                            <li class="sidebar-item-container">
                                <a class="sidebar-item" href="#InstructionIntegerMap">InstructionIntegerMap</a>
                            </li>
                            <li class="sidebar-item-container">
                                <a class="sidebar-item" href="#BasicBlockToInteger">BasicBlockToInteger</a>
                            </li>
                            <li class="sidebar-item-container">
                                <a class="sidebar-item" href="#AddedIllegalLastTime">AddedIllegalLastTime</a>
                            </li>
                            <li class="sidebar-item-container">
                                <a class="sidebar-item" href="#CanCombineWithPrevInstr">CanCombineWithPrevInstr</a>
                            </li>
                            <li class="sidebar-item-container">
                                <a class="sidebar-item" href="#HaveLegalRange">HaveLegalRange</a>
                            </li>
                            <li class="sidebar-item-container">
                                <a class="sidebar-item" href="#EnableMatchCallsByName">EnableMatchCallsByName</a>
                            </li>
                            <li class="sidebar-item-container">
                                <a class="sidebar-item" href="#InstDataAllocator">InstDataAllocator</a>
                            </li>
                            <li class="sidebar-item-container">
                                <a class="sidebar-item" href="#IDLAllocator">IDLAllocator</a>
                            </li>
                            <li class="sidebar-item-container">
                                <a class="sidebar-item" href="#IDL">IDL</a>
                            </li>
                            <li class="sidebar-item-container">
                                <a class="sidebar-item" href="#InstClassifier">InstClassifier</a>
                            </li>
                        </ul>
                    </li>
                    <li class="sidebar-section">
                        <a class="sidebar-item" href="#PublicMethods">Public Method</a>
                    </li>
                    <li>
                        <ul>
                            <li class="sidebar-item-container">
                                <a class="sidebar-item" href="#6EEA9D064E87766E1229C0381307D559514007A9">allocateIRInstructionData</a>
                            </li>
                            <li class="sidebar-item-container">
                                <a class="sidebar-item" href="#6529906D675E6F461C7FAE075C26A5DAFF090200">allocateIRInstructionData</a>
                            </li>
                            <li class="sidebar-item-container">
                                <a class="sidebar-item" href="#E1EB4172F411C82947B009F94EFFC6CF375C7245">allocateIRInstructionDataList</a>
                            </li>
                            <li class="sidebar-item-container">
                                <a class="sidebar-item" href="#D1807FE929E3F1ADE6D7D905C4152E0C9677B483">convertToUnsignedVec</a>
                            </li>
                            <li class="sidebar-item-container">
                                <a class="sidebar-item" href="#463FAC89432C0B52996C932242B98A6386FBCB76">mapToLegalUnsigned</a>
                            </li>
                            <li class="sidebar-item-container">
                                <a class="sidebar-item" href="#F1D34E8715C6D5B0DD37FDC3047D00F75CB6E247">mapToIllegalUnsigned</a>
                            </li>
                            <li class="sidebar-item-container">
                                <a class="sidebar-item" href="#7085DDF74171480C383809DF595B4E5265E2D3E6">initializeForBBs</a>
                            </li>
                            <li class="sidebar-item-container">
                                <a class="sidebar-item" href="#1299F1EED5E3F99EA83E24E54F92E93198EE387D">initializeForBBs</a>
                            </li>
                            <li class="sidebar-item-container">
                                <a class="sidebar-item" href="#83E1B7CED34D514F09FDF1F805DFDBCB80CAA66B">IRInstructionMapper</a>
                            </li>
                            <li class="sidebar-item-container">
                                <a class="sidebar-item" href="#CB7DA401205ED7BDEFC8C8E511119109703C4AAF">convertToUnsignedVec</a>
                            </li>
                            <li class="sidebar-item-container">
                                <a class="sidebar-item" href="#2C7B9D9033900D23042BB8F9F160E6EDD1CC4006">mapToLegalUnsigned</a>
                            </li>
                            <li class="sidebar-item-container">
                                <a class="sidebar-item" href="#4986732D7630BD5E93B9D418E0673B69BCAC443B">mapToIllegalUnsigned</a>
                            </li>
                        </ul>
                    </li>
                </ul>
            </div>
            <div class="resizer" id="resizer"></div>
            <div class="content">
                <section class="hero section-container">
                    <div class="hero__title">
                        <h1 class="hero__title-large">struct IRInstructionMapper</h1>
                        <p>Defined at line 380 of file llvm/include/llvm/Analysis/IRSimilarityIdentifier.h</p>
                        <div class="hero__subtitle">
                            <div>
                                <p> Helper struct for converting the Instructions in a Module into a vector of</p>
                                <p> unsigned integers. This vector of unsigned integers can be thought of as a</p>
                                <p> &quot;numeric string&quot;. This numeric string can then be queried by, for example,</p>
                                <p> data structures that find repeated substrings.</p>
                            </div>
                            <div>
                                <p> This hashing is done per BasicBlock in the module. To hash Instructions</p>
                                <p> based off of their operations, each Instruction is wrapped in an</p>
                                <p> IRInstructionData struct. The unsigned integer for an IRInstructionData</p>
                                <p> depends on:</p>
                                <p> - The hash provided by the IRInstructionData.</p>
                                <p> - Which member of InstrType the IRInstructionData is classified as.</p>
                                <p> See InstrType for more details on the possible classifications, and how they</p>
                                <p> manifest in the numeric string.</p>
                            </div>
                            <div>
                                <p> The numeric string for an individual BasicBlock is terminated by an unique</p>
                                <p> unsigned integer. This prevents data structures which rely on repetition</p>
                                <p> from matching across BasicBlocks. (For example, the SuffixTree.)</p>
                                <p> As a concrete example, if we have the following two BasicBlocks:</p>
                            </div>
                            <div>
                                <p> We may hash the Instructions like this (via IRInstructionData):</p>
                            </div>
                            <div>
                                <p> And produce a &quot;numeric string representation&quot; like so:</p>
                                <p> 1, 1, 2, unique_integer_1, 3, 1, unique_integer_2</p>
                            </div>
                            <div>
                                <p> TODO: This is very similar to the MachineOutliner, and should be</p>
                                <p> consolidated into the same interface.</p>
                            </div>
                            <h3>Code</h3> 
                            <div>
                                <pre class="code-block">
                                    <code>
                                         bb0:
                                         %add1 = add i32 %a, %b
                                         %add2 = add i32 %c, %d
                                         %add3 = add i64 %e, %f
                                         bb1:
                                         %sub = sub i32 %c, %d
                                    </code>
                                </pre>
                            </div>
                            <div>
                                <pre class="code-block">
                                    <code>
                                         bb0:
                                         %add1 = add i32 %a, %b ; Hash: 1
                                         %add2 = add i32 %c, %d; Hash: 1
                                         %add3 = add i64 %e, %f; Hash: 2
                                         bb1:
                                         %sub = sub i32 %c, %d; Hash: 3
                                         %add4 = add i32 %c, %d ; Hash: 1
                                    </code>
                                </pre>
                            </div>
                        </div>
                    </div>
                </section>
                <section id="PublicMembers" class="section-container">
                    <h2>Public Members</h2>
                    <div>
                        <div id="IllegalInstrNumber" class="delimiter-container">
                            <pre><code class="language-cpp code-clang-doc" >unsigned int IllegalInstrNumber</code></pre>
                        </div>
                        <div id="LegalInstrNumber" class="delimiter-container">
                            <pre><code class="language-cpp code-clang-doc" >unsigned int LegalInstrNumber</code></pre>
                        </div>
                        <div id="InstructionIntegerMap" class="delimiter-container">
                            <pre><code class="language-cpp code-clang-doc" >DenseMap InstructionIntegerMap</code></pre>
                        </div>
                        <div id="BasicBlockToInteger" class="delimiter-container">
                            <pre><code class="language-cpp code-clang-doc" >DenseMap BasicBlockToInteger</code></pre>
                        </div>
                        <div id="AddedIllegalLastTime" class="delimiter-container">
                            <pre><code class="language-cpp code-clang-doc" >bool AddedIllegalLastTime</code></pre>
                        </div>
                        <div id="CanCombineWithPrevInstr" class="delimiter-container">
                            <pre><code class="language-cpp code-clang-doc" >bool CanCombineWithPrevInstr</code></pre>
                        </div>
                        <div id="HaveLegalRange" class="delimiter-container">
                            <pre><code class="language-cpp code-clang-doc" >bool HaveLegalRange</code></pre>
                        </div>
                        <div id="EnableMatchCallsByName" class="delimiter-container">
                            <pre><code class="language-cpp code-clang-doc" >bool EnableMatchCallsByName</code></pre>
                        </div>
                        <div id="InstDataAllocator" class="delimiter-container">
                            <pre><code class="language-cpp code-clang-doc" >SpecificBumpPtrAllocator&lt;IRInstructionData&gt; * InstDataAllocator</code></pre>
                        </div>
                        <div id="IDLAllocator" class="delimiter-container">
                            <pre><code class="language-cpp code-clang-doc" >SpecificBumpPtrAllocator&lt;IRInstructionDataList&gt; * IDLAllocator</code></pre>
                        </div>
                        <div id="IDL" class="delimiter-container">
                            <pre><code class="language-cpp code-clang-doc" >IRInstructionDataList * IDL</code></pre>
                        </div>
                        <div id="InstClassifier" class="delimiter-container">
                            <pre><code class="language-cpp code-clang-doc" >InstructionClassification InstClassifier</code></pre>
                        </div>
                    </div>
                </section>
                <section id="PublicMethods" class="section-container">
                    <h2>Public Methods</h2>
                    <div>
                        <div class="delimiter-container">
                            <div id="6EEA9D064E87766E1229C0381307D559514007A9">
                                <pre><code class="language-cpp code-clang-doc">IRInstructionData * allocateIRInstructionData (Instruction &amp; I, bool Legality, IRInstructionDataList &amp; IDL)</code></pre>
                                <div>
                                    <div>
                                        <p> Get an allocated IRInstructionData struct using the InstDataAllocator.</p>
                                    </div>
                                    <h3>Parameters</h3>
                                    <div>
                                        <b>I</b>   - The Instruction to wrap with IRInstructionData.
                                    </div> 
                                    <div>
                                        <b>Legality</b>   - A boolean value that is true if the instruction is to be considered for similarity, and false if not.
                                    </div> 
                                    <div>
                                        <b>IDL</b>   - The InstructionDataList that the IRInstructionData is inserted into.
                                    </div> 
                                </div>
                                <p>Defined at line 374 of file llvm/lib/Analysis/IRSimilarityIdentifier.cpp</p>
                            </div>
                        </div>
                        <div class="delimiter-container">
                            <div id="6529906D675E6F461C7FAE075C26A5DAFF090200">
                                <pre><code class="language-cpp code-clang-doc">IRInstructionData * allocateIRInstructionData (IRInstructionDataList &amp; IDL)</code></pre>
                                <div>
                                    <div>
                                        <p> Get an empty allocated IRInstructionData struct using the</p>
                                        <p> InstDataAllocator.</p>
                                    </div>
                                    <h3>Parameters</h3>
                                    <div>
                                        <b>IDL</b>   - The InstructionDataList that the IRInstructionData is inserted into.
                                    </div> 
                                </div>
                                <p>Defined at line 380 of file llvm/lib/Analysis/IRSimilarityIdentifier.cpp</p>
                            </div>
                        </div>
                        <div class="delimiter-container">
                            <div id="E1EB4172F411C82947B009F94EFFC6CF375C7245">
                                <pre><code class="language-cpp code-clang-doc">IRInstructionDataList * allocateIRInstructionDataList ()</code></pre>
                                <div>
                                    <div>
                                        <p> Get an allocated IRInstructionDataList object using the IDLAllocator.</p>
                                    </div>
                                </div>
                                <p>Defined at line 385 of file llvm/lib/Analysis/IRSimilarityIdentifier.cpp</p>
                            </div>
                        </div>
                        <div class="delimiter-container">
                            <div id="D1807FE929E3F1ADE6D7D905C4152E0C9677B483">
                                <pre><code class="language-cpp code-clang-doc">void convertToUnsignedVec (BasicBlock &amp; BB, std::vector&lt;IRInstructionData *&gt; &amp; InstrList, std::vector&lt;unsigned int&gt; &amp; IntegerMapping)</code></pre>
                                <div>
                                    <div>
                                        <p> Maps the Instructions in a BasicBlock </p>
                                        <p> to legal or illegal integers</p>
                                        <p> determined by </p>
                                        <p> Two Instructions are mapped to the same value</p>
                                        <p> if they are close as defined by the InstructionData class above.</p>
                                    </div>
                                    <h3>Parameters</h3>
                                    <div>
                                        <b>BB</b> [in]  - The BasicBlock to be mapped to integers.
                                    </div> 
                                    <div>
                                        <b>InstrList</b> [in,out]  - Vector of IRInstructionData to append to.
                                    </div> 
                                    <div>
                                        <b>IntegerMapping</b> [in,out]  - Vector of unsigned integers to append to.
                                    </div> 
                                </div>
                                <p>Defined at line 289 of file llvm/lib/Analysis/IRSimilarityIdentifier.cpp</p>
                            </div>
                        </div>
                        <div class="delimiter-container">
                            <div id="463FAC89432C0B52996C932242B98A6386FBCB76">
                                <pre><code class="language-cpp code-clang-doc">unsigned int mapToLegalUnsigned (BasicBlock::iterator &amp; It, std::vector&lt;unsigned int&gt; &amp; IntegerMappingForBB, std::vector&lt;IRInstructionData *&gt; &amp; InstrListForBB)</code></pre>
                                <div>
                                    <div>
                                        <p> Maps an Instruction to a legal integer.</p>
                                    </div>
                                    <h3>Parameters</h3>
                                    <div>
                                        <b>It</b> [in]  - The Instruction to be mapped to an integer.
                                    </div> 
                                    <div>
                                        <b>IntegerMappingForBB</b> [in,out]  - Vector of unsigned integers to append to.
                                    </div> 
                                    <div>
                                        <b>InstrListForBB</b> [in,out]  - Vector of InstructionData to append to.
                                    </div> 
                                </div>
                                <p>Defined at line 321 of file llvm/lib/Analysis/IRSimilarityIdentifier.cpp</p>
                            </div>
                        </div>
                        <div class="delimiter-container">
                            <div id="F1D34E8715C6D5B0DD37FDC3047D00F75CB6E247">
                                <pre><code class="language-cpp code-clang-doc">unsigned int mapToIllegalUnsigned (BasicBlock::iterator &amp; It, std::vector&lt;unsigned int&gt; &amp; IntegerMappingForBB, std::vector&lt;IRInstructionData *&gt; &amp; InstrListForBB, bool End)</code></pre>
                                <div>
                                    <div>
                                        <p> Maps an Instruction to an illegal integer.</p>
                                    </div>
                                    <h3>Parameters</h3>
                                    <div>
                                        <b>It</b> [in]  - The  to be mapped to an integer.
                                    </div> 
                                    <div>
                                        <b>IntegerMappingForBB</b> [in,out]  - Vector of unsigned integers to append to.
                                    </div> 
                                    <div>
                                        <b>InstrListForBB</b> [in,out]  - Vector of IRInstructionData to append to.
                                    </div> 
                                    <div>
                                        <b>End</b>   - true if creating a dummy IRInstructionData at the end of a basic block.
                                    </div> 
                                </div>
                                <p>Defined at line 392 of file llvm/lib/Analysis/IRSimilarityIdentifier.cpp</p>
                            </div>
                        </div>
                        <div class="delimiter-container">
                            <div id="7085DDF74171480C383809DF595B4E5265E2D3E6">
                                <pre><code class="language-cpp code-clang-doc">void initializeForBBs (Function &amp; F, unsigned int &amp; BBNumber)</code></pre>
                                <div>
                                    <div>
                                        <p> Assigns values to all the basic blocks in function </p>
                                        <p> starting from</p>
                                        <p> integer </p>
                                    </div>
                                    <h3>Parameters</h3>
                                    <div>
                                        <b>F</b>   - The function containing the basic blocks to assign numbers to.
                                    </div> 
                                    <div>
                                        <b>BBNumber</b>   - The number to start from.
                                    </div> 
                                </div>
                                <p>Defined at line 457 of file llvm/include/llvm/Analysis/IRSimilarityIdentifier.h</p>
                            </div>
                        </div>
                        <div class="delimiter-container">
                            <div id="1299F1EED5E3F99EA83E24E54F92E93198EE387D">
                                <pre><code class="language-cpp code-clang-doc">void initializeForBBs (Module &amp; M)</code></pre>
                                <div>
                                    <div>
                                        <p> Assigns values to all the basic blocks in Module </p>
                                    </div>
                                    <h3>Parameters</h3>
                                    <div>
                                        <b>M</b>   - The module containing the basic blocks to assign numbers to.
                                    </div> 
                                </div>
                                <p>Defined at line 464 of file llvm/include/llvm/Analysis/IRSimilarityIdentifier.h</p>
                            </div>
                        </div>
                        <div class="delimiter-container">
                            <div id="83E1B7CED34D514F09FDF1F805DFDBCB80CAA66B">
                                <pre><code class="language-cpp code-clang-doc">void IRInstructionMapper (SpecificBumpPtrAllocator&lt;IRInstructionData&gt; * IDA, SpecificBumpPtrAllocator&lt;IRInstructionDataList&gt; * IDLA)</code></pre>
                                <p>Defined at line 507 of file llvm/include/llvm/Analysis/IRSimilarityIdentifier.h</p>
                            </div>
                        </div>
                        <div class="delimiter-container">
                            <div id="CB7DA401205ED7BDEFC8C8E511119109703C4AAF">
                                <pre><code class="language-cpp code-clang-doc">void convertToUnsignedVec (BasicBlock &amp; BB, int &amp; InstrList, int &amp; IntegerMapping)</code></pre>
                                <div>
                                    <div>
                                        <p> Maps the Instructions in a BasicBlock </p>
                                        <p> to legal or illegal integers</p>
                                        <p> determined by </p>
                                        <p> Two Instructions are mapped to the same value</p>
                                        <p> if they are close as defined by the InstructionData class above.</p>
                                    </div>
                                    <h3>Parameters</h3>
                                    <div>
                                        <b>BB</b> [in]  - The BasicBlock to be mapped to integers.
                                    </div> 
                                    <div>
                                        <b>InstrList</b> [in,out]  - Vector of IRInstructionData to append to.
                                    </div> 
                                    <div>
                                        <b>IntegerMapping</b> [in,out]  - Vector of unsigned integers to append to.
                                    </div> 
                                </div>
                                <p>Defined at line  of file </p>
                            </div>
                        </div>
                        <div class="delimiter-container">
                            <div id="2C7B9D9033900D23042BB8F9F160E6EDD1CC4006">
                                <pre><code class="language-cpp code-clang-doc">unsigned int mapToLegalUnsigned (BasicBlock::iterator &amp; It, int &amp; IntegerMappingForBB, int &amp; InstrListForBB)</code></pre>
                                <div>
                                    <div>
                                        <p> Maps an Instruction to a legal integer.</p>
                                    </div>
                                    <h3>Parameters</h3>
                                    <div>
                                        <b>It</b> [in]  - The Instruction to be mapped to an integer.
                                    </div> 
                                    <div>
                                        <b>IntegerMappingForBB</b> [in,out]  - Vector of unsigned integers to append to.
                                    </div> 
                                    <div>
                                        <b>InstrListForBB</b> [in,out]  - Vector of InstructionData to append to.
                                    </div> 
                                </div>
                                <p>Defined at line  of file </p>
                            </div>
                        </div>
                        <div class="delimiter-container">
                            <div id="4986732D7630BD5E93B9D418E0673B69BCAC443B">
                                <pre><code class="language-cpp code-clang-doc">unsigned int mapToIllegalUnsigned (BasicBlock::iterator &amp; It, int &amp; IntegerMappingForBB, int &amp; InstrListForBB, bool End)</code></pre>
                                <div>
                                    <div>
                                        <p> Maps an Instruction to an illegal integer.</p>
                                    </div>
                                    <h3>Parameters</h3>
                                    <div>
                                        <b>It</b> [in]  - The  to be mapped to an integer.
                                    </div> 
                                    <div>
                                        <b>IntegerMappingForBB</b> [in,out]  - Vector of unsigned integers to append to.
                                    </div> 
                                    <div>
                                        <b>InstrListForBB</b> [in,out]  - Vector of IRInstructionData to append to.
                                    </div> 
                                    <div>
                                        <b>End</b>   - true if creating a dummy IRInstructionData at the end of a basic block.
                                    </div> 
                                </div>
                                <p>Defined at line  of file </p>
                            </div>
                        </div>
                    </div>
                </section>
            </div>
        </div>
    </main>
</body>
</html>

<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset="utf-8"/>
    <title>CanonicalLoopInfo</title>
        <link rel="stylesheet" type="text/css" href="../clang-doc-mustache.css"/>
        <script src="../mustache-index.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/default.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/cpp.min.js"></script>
</head>
<body>
    <nav class="navbar">
        <div class="navbar__container">
            <div class="navbar__logo">
                
            </div>
            <div class="navbar__menu">
                <ul class="navbar__links">
                    <li class="navbar__item">
                        <a href="../index.html" class="navbar__link">Home</a>
                    </li>
                </ul>
            </div>
            <div class="navbar-breadcrumb-container">
                <div class="navbar-breadcrumb-item"><a href="../GlobalNamespace/index.html">Global Namespace</a></div>&rarr;
                <div class="navbar-breadcrumb-item"><a href="./index.html">llvm</a></div>
            </div>
        </div>
    </nav>
    <main>
        <div class="container">
            <div class="sidebar">
                <h2>class CanonicalLoopInfo</h2>
                <ul>
                    <li class="sidebar-section">
                        <a class="sidebar-item" href="#PublicMethods">Public Method</a>
                    </li>
                    <li>
                        <ul>
                            <li class="sidebar-item-container">
                                <a class="sidebar-item" href="#6B27EE557C55F934137495DF4C967E5CCBA60F9F">setLastIter</a>
                            </li>
                            <li class="sidebar-item-container">
                                <a class="sidebar-item" href="#4B586411CEB8F9AB7E93709510634ED28E4BD3A5">getLastIter</a>
                            </li>
                            <li class="sidebar-item-container">
                                <a class="sidebar-item" href="#60371D68FCB2C17CADFC46032180B6DB8F5B3E47">isValid</a>
                            </li>
                            <li class="sidebar-item-container">
                                <a class="sidebar-item" href="#1A69C7E380F8E61F349605C5FDD88D641E1747D4">getHeader</a>
                            </li>
                            <li class="sidebar-item-container">
                                <a class="sidebar-item" href="#D2224FD73770EF0E8EC0F22C10C7D1B226EFF31E">getCond</a>
                            </li>
                            <li class="sidebar-item-container">
                                <a class="sidebar-item" href="#579D5C4194342F24A8B167EBF0EA82A6113F7F31">getBody</a>
                            </li>
                            <li class="sidebar-item-container">
                                <a class="sidebar-item" href="#FFA0605ADAB3A2A4DD625F4D20C2A5CB0A5AA306">getLatch</a>
                            </li>
                            <li class="sidebar-item-container">
                                <a class="sidebar-item" href="#E199D74FFAAB5E9E39355E2CA63E0FF83966A8C8">getExit</a>
                            </li>
                            <li class="sidebar-item-container">
                                <a class="sidebar-item" href="#73CAEF7D28DB94AB523CD148C658F13A637F8C8D">getAfter</a>
                            </li>
                            <li class="sidebar-item-container">
                                <a class="sidebar-item" href="#B20F46F5D2229C24384C5E271D222E1D7B64FAFA">getTripCount</a>
                            </li>
                            <li class="sidebar-item-container">
                                <a class="sidebar-item" href="#7247C8FD7ECC2D2710AE8A27A680ACBBC3BA7684">getIndVar</a>
                            </li>
                            <li class="sidebar-item-container">
                                <a class="sidebar-item" href="#6C4B68F2AC84A3F86FC158ED71CF8DA2E954072C">getIndVarType</a>
                            </li>
                            <li class="sidebar-item-container">
                                <a class="sidebar-item" href="#EF32BC375E5D760B10BB41A8F0CC89129119E535">getPreheaderIP</a>
                            </li>
                            <li class="sidebar-item-container">
                                <a class="sidebar-item" href="#49BFD0F8227C061EF4CE030070A1F8B8BFC4218C">getBodyIP</a>
                            </li>
                            <li class="sidebar-item-container">
                                <a class="sidebar-item" href="#BD149F584BBDD067E975A2F56877217DF94E8696">getAfterIP</a>
                            </li>
                            <li class="sidebar-item-container">
                                <a class="sidebar-item" href="#FAC59110E0D66EACF22323E60637EAABDE3BE2E6">getFunction</a>
                            </li>
                            <li class="sidebar-item-container">
                                <a class="sidebar-item" href="#DB5E5358E0B8073FD8DE1042369783C64FEE7572">getPreheader</a>
                            </li>
                            <li class="sidebar-item-container">
                                <a class="sidebar-item" href="#FD6CF901EA2EC1C80719D059EB0C02AFC87550B9">assertOK</a>
                            </li>
                            <li class="sidebar-item-container">
                                <a class="sidebar-item" href="#C6E3BE002F2FB9CA734626946B68E1A7469EBB48">invalidate</a>
                            </li>
                        </ul>
                    </li>
                </ul>
            </div>
            <div class="resizer" id="resizer"></div>
            <div class="content">
                <section class="hero section-container">
                    <div class="hero__title">
                        <h1 class="hero__title-large">class CanonicalLoopInfo</h1>
                        <p>Defined at line 3855 of file llvm/include/llvm/Frontend/OpenMP/OMPIRBuilder.h</p>
                        <div class="hero__subtitle">
                            <div>
                                <p> Class to represented the control flow structure of an OpenMP canonical loop.</p>
                            </div>
                            <div>
                                <p> The control-flow structure is standardized for easy consumption by</p>
                                <p> directives associated with loops. For instance, the worksharing-loop</p>
                                <p> construct may change this control flow such that each loop iteration is</p>
                                <p> executed on only one thread. The constraints of a canonical loop in brief</p>
                                <p> are:</p>
                            </div>
                            <div>
                                <p>  * The number of loop iterations must have been computed before entering the</p>
                                <p>    loop.</p>
                            </div>
                            <div>
                                <p>  * Has an (unsigned) logical induction variable that starts at zero and</p>
                                <p>    increments by one.</p>
                            </div>
                            <div>
                                <p>  * The loop&#39;s CFG itself has no side-effects. The OpenMP specification</p>
                                <p>    itself allows side-effects, but the order in which they happen, including</p>
                                <p>    how often or whether at all, is unspecified. We expect that the frontend</p>
                                <p>    will emit those side-effect instructions somewhere (e.g. before the loop)</p>
                                <p>    such that the CanonicalLoopInfo itself can be side-effect free.</p>
                            </div>
                            <div>
                                <p> Keep in mind that CanonicalLoopInfo is meant to only describe a repeated</p>
                                <p> execution of a loop body that satifies these constraints. It does NOT</p>
                                <p> represent arbitrary SESE regions that happen to contain a loop. Do not use</p>
                                <p> CanonicalLoopInfo for such purposes.</p>
                            </div>
                            <div>
                                <p> The control flow can be described as follows:</p>
                            </div>
                            <div>
                                <p>     Preheader</p>
                                <p>        |</p>
                                <p>  /-&gt; Header</p>
                                <p>  |     |</p>
                                <p>  |    Cond---</p>
                                <p>\</p>
                                <p>///  |     |     |</p>
                                <p>  |    Body   |</p>
                                <p>  |    | |    |</p>
                                <p>  |   </p>
                                <p>&lt;</p>
                                <p>...&gt;   |</p>
                                <p>  |    | |    |</p>
                                <p>\</p>
                                <p>--Latch   |</p>
                                <p>              |</p>
                                <p>             Exit</p>
                                <p>              |</p>
                                <p>            After</p>
                            </div>
                            <div>
                                <p> The loop is thought to start at PreheaderIP (at the Preheader&#39;s terminator,</p>
                                <p> including) and end at AfterIP (at the After&#39;s first instruction, excluding).</p>
                                <p> That is, instructions in the Preheader and After blocks (except the</p>
                                <p> Preheader&#39;s terminator) are out of CanonicalLoopInfo&#39;s control and may have</p>
                                <p> side-effects. Typically, the Preheader is used to compute the loop&#39;s trip</p>
                                <p> count. The instructions from BodyIP (at the Body block&#39;s first instruction,</p>
                                <p> excluding) until the Latch are also considered outside CanonicalLoopInfo&#39;s</p>
                                <p> control and thus can have side-effects. The body block is the single entry</p>
                                <p> point into the loop body, which may contain arbitrary control flow as long</p>
                                <p> as all control paths eventually branch to the Latch block.</p>
                            </div>
                            <div>
                                <p> TODO: Consider adding another standardized BasicBlock between Body CFG and</p>
                                <p> Latch to guarantee that there is only a single edge to the latch. It would</p>
                                <p> make loop transformations easier to not needing to consider multiple</p>
                                <p> predecessors of the latch (See redirectAllPredecessorsTo) and would give us</p>
                                <p> an equivalant to PreheaderIP, AfterIP and BodyIP for inserting code that</p>
                                <p> executes after each body iteration.</p>
                            </div>
                            <div>
                                <p> There must be no loop-carried dependencies through llvm::Values. This is</p>
                                <p> equivalant to that the Latch has no PHINode and the Header&#39;s only PHINode is</p>
                                <p> for the induction variable.</p>
                            </div>
                            <div>
                                <p> All code in Header, Cond, Latch and Exit (plus the terminator of the</p>
                                <p> Preheader) are CanonicalLoopInfo&#39;s responsibility and their build-up checked</p>
                                <p> by assertOK(). They are expected to not be modified unless explicitly</p>
                                <p> modifying the CanonicalLoopInfo through a methods that applies a OpenMP</p>
                                <p> loop-associated construct such as applyWorkshareLoop, tileLoops, unrollLoop,</p>
                                <p> etc. These methods usually invalidate the CanonicalLoopInfo and re-use its</p>
                                <p> basic blocks. After invalidation, the CanonicalLoopInfo must not be used</p>
                                <p> anymore as its underlying control flow may not exist anymore.</p>
                                <p> Loop-transformation methods such as tileLoops, collapseLoops and unrollLoop</p>
                                <p> may also return a new CanonicalLoopInfo that can be passed to other</p>
                                <p> loop-associated construct implementing methods. These loop-transforming</p>
                                <p> methods may either create a new CanonicalLoopInfo usually using</p>
                                <p> createLoopSkeleton and invalidate the input CanonicalLoopInfo, or reuse and</p>
                                <p> modify one of the input CanonicalLoopInfo and return it as representing the</p>
                                <p> modified loop. What is done is an implementation detail of</p>
                                <p> transformation-implementing method and callers should always assume that the</p>
                                <p> CanonicalLoopInfo passed to it is invalidated and a new object is returned.</p>
                                <p> Returned CanonicalLoopInfo have the same structure and guarantees as the one</p>
                                <p> created by createCanonicalLoop, such that transforming methods do not have</p>
                                <p> to special case where the CanonicalLoopInfo originated from.</p>
                            </div>
                            <div>
                                <p> Generally, methods consuming CanonicalLoopInfo do not need an</p>
                                <p> OpenMPIRBuilder::InsertPointTy as argument, but use the locations of the</p>
                                <p> CanonicalLoopInfo to insert new or modify existing instructions. Unless</p>
                                <p> documented otherwise, methods consuming CanonicalLoopInfo do not invalidate</p>
                                <p> any InsertPoint that is outside CanonicalLoopInfo&#39;s control. Specifically,</p>
                                <p> any InsertPoint in the Preheader, After or Block can still be used after</p>
                                <p> calling such a method.</p>
                            </div>
                            <div>
                                <p> TODO: Provide mechanisms for exception handling and cancellation points.</p>
                            </div>
                            <div>
                                <p> Defined outside OpenMPIRBuilder because nested classes cannot be</p>
                                <p> forward-declared, e.g. to avoid having to include the entire OMPIRBuilder.h.</p>
                            </div>
                        </div>
                    </div>
                </section>
                <section id="PublicMethods" class="section-container">
                    <h2>Public Methods</h2>
                    <div>
                        <div class="delimiter-container">
                            <div id="6B27EE557C55F934137495DF4C967E5CCBA60F9F">
                                <pre><code class="language-cpp code-clang-doc">void setLastIter (Value * IterVar)</code></pre>
                                <div>
                                    <div>
                                        <p> Sets the last iteration variable for this loop.</p>
                                    </div>
                                </div>
                                <p>Defined at line 3900 of file llvm/include/llvm/Frontend/OpenMP/OMPIRBuilder.h</p>
                            </div>
                        </div>
                        <div class="delimiter-container">
                            <div id="4B586411CEB8F9AB7E93709510634ED28E4BD3A5">
                                <pre><code class="language-cpp code-clang-doc">Value * getLastIter ()</code></pre>
                                <div>
                                    <div>
                                        <p> Returns the last iteration variable for this loop.</p>
                                        <p> Certain use-cases (like translation of linear clause) may access</p>
                                        <p> this variable even after a loop transformation. Hence, do not guard</p>
                                        <p> this getter function by `isValid`. It is the responsibility of the</p>
                                        <p> callee to ensure this functionality is not invoked by a non-outlined</p>
                                        <p> CanonicalLoopInfo object (in which case, `setLastIter` will never be</p>
                                        <p> invoked and `LastIter` will be by default `nullptr`).</p>
                                    </div>
                                </div>
                                <p>Defined at line 3909 of file llvm/include/llvm/Frontend/OpenMP/OMPIRBuilder.h</p>
                            </div>
                        </div>
                        <div class="delimiter-container">
                            <div id="60371D68FCB2C17CADFC46032180B6DB8F5B3E47">
                                <pre><code class="language-cpp code-clang-doc">bool isValid ()</code></pre>
                                <div>
                                    <div>
                                        <p> Returns whether this object currently represents the IR of a loop. If</p>
                                        <p> returning false, it may have been consumed by a loop transformation or not</p>
                                        <p> been intialized. Do not use in this case;</p>
                                    </div>
                                </div>
                                <p>Defined at line 3914 of file llvm/include/llvm/Frontend/OpenMP/OMPIRBuilder.h</p>
                            </div>
                        </div>
                        <div class="delimiter-container">
                            <div id="1A69C7E380F8E61F349605C5FDD88D641E1747D4">
                                <pre><code class="language-cpp code-clang-doc">BasicBlock * getHeader ()</code></pre>
                                <div>
                                    <div>
                                        <p> The header is the entry for each iteration. In the canonical control flow,</p>
                                        <p> it only contains the PHINode for the induction variable.</p>
                                    </div>
                                </div>
                                <p>Defined at line 3924 of file llvm/include/llvm/Frontend/OpenMP/OMPIRBuilder.h</p>
                            </div>
                        </div>
                        <div class="delimiter-container">
                            <div id="D2224FD73770EF0E8EC0F22C10C7D1B226EFF31E">
                                <pre><code class="language-cpp code-clang-doc">BasicBlock * getCond ()</code></pre>
                                <div>
                                    <div>
                                        <p> The condition block computes whether there is another loop iteration. If</p>
                                        <p> yes, branches to the body; otherwise to the exit block.</p>
                                    </div>
                                </div>
                                <p>Defined at line 3931 of file llvm/include/llvm/Frontend/OpenMP/OMPIRBuilder.h</p>
                            </div>
                        </div>
                        <div class="delimiter-container">
                            <div id="579D5C4194342F24A8B167EBF0EA82A6113F7F31">
                                <pre><code class="language-cpp code-clang-doc">BasicBlock * getBody ()</code></pre>
                                <div>
                                    <div>
                                        <p> The body block is the single entry for a loop iteration and not controlled</p>
                                        <p> by CanonicalLoopInfo. It can contain arbitrary control flow but must</p>
                                        <p> eventually branch to the </p>
                                        <p> block.</p>
                                    </div>
                                </div>
                                <p>Defined at line 3939 of file llvm/include/llvm/Frontend/OpenMP/OMPIRBuilder.h</p>
                            </div>
                        </div>
                        <div class="delimiter-container">
                            <div id="FFA0605ADAB3A2A4DD625F4D20C2A5CB0A5AA306">
                                <pre><code class="language-cpp code-clang-doc">BasicBlock * getLatch ()</code></pre>
                                <div>
                                    <div>
                                        <p> Reaching the latch indicates the end of the loop body code. In the</p>
                                        <p> canonical control flow, it only contains the increment of the induction</p>
                                        <p> variable.</p>
                                    </div>
                                </div>
                                <p>Defined at line 3947 of file llvm/include/llvm/Frontend/OpenMP/OMPIRBuilder.h</p>
                            </div>
                        </div>
                        <div class="delimiter-container">
                            <div id="E199D74FFAAB5E9E39355E2CA63E0FF83966A8C8">
                                <pre><code class="language-cpp code-clang-doc">BasicBlock * getExit ()</code></pre>
                                <div>
                                    <div>
                                        <p> Reaching the exit indicates no more iterations are being executed.</p>
                                    </div>
                                </div>
                                <p>Defined at line 3953 of file llvm/include/llvm/Frontend/OpenMP/OMPIRBuilder.h</p>
                            </div>
                        </div>
                        <div class="delimiter-container">
                            <div id="73CAEF7D28DB94AB523CD148C658F13A637F8C8D">
                                <pre><code class="language-cpp code-clang-doc">BasicBlock * getAfter ()</code></pre>
                                <div>
                                    <div>
                                        <p> The after block is intended for clean-up code such as lifetime end</p>
                                        <p> markers. It is separate from the exit block to ensure, analogous to the</p>
                                        <p> preheader, it having just a single entry edge and being free from PHI</p>
                                        <p> nodes should there be multiple loop exits (such as from break</p>
                                        <p> statements/cancellations).</p>
                                    </div>
                                </div>
                                <p>Defined at line 3963 of file llvm/include/llvm/Frontend/OpenMP/OMPIRBuilder.h</p>
                            </div>
                        </div>
                        <div class="delimiter-container">
                            <div id="B20F46F5D2229C24384C5E271D222E1D7B64FAFA">
                                <pre><code class="language-cpp code-clang-doc">Value * getTripCount ()</code></pre>
                                <div>
                                    <div>
                                        <p> Returns the llvm::Value containing the number of loop iterations. It must</p>
                                        <p> be valid in the preheader and always interpreted as an unsigned integer of</p>
                                        <p> any bit-width.</p>
                                    </div>
                                </div>
                                <p>Defined at line 3971 of file llvm/include/llvm/Frontend/OpenMP/OMPIRBuilder.h</p>
                            </div>
                        </div>
                        <div class="delimiter-container">
                            <div id="7247C8FD7ECC2D2710AE8A27A680ACBBC3BA7684">
                                <pre><code class="language-cpp code-clang-doc">Instruction * getIndVar ()</code></pre>
                                <div>
                                    <div>
                                        <p> Returns the instruction representing the current logical induction</p>
                                        <p> variable. Always unsigned, always starting at 0 with an increment of one.</p>
                                    </div>
                                </div>
                                <p>Defined at line 3980 of file llvm/include/llvm/Frontend/OpenMP/OMPIRBuilder.h</p>
                            </div>
                        </div>
                        <div class="delimiter-container">
                            <div id="6C4B68F2AC84A3F86FC158ED71CF8DA2E954072C">
                                <pre><code class="language-cpp code-clang-doc">Type * getIndVarType ()</code></pre>
                                <div>
                                    <div>
                                        <p> Return the type of the induction variable (and the trip count).</p>
                                    </div>
                                </div>
                                <p>Defined at line 3988 of file llvm/include/llvm/Frontend/OpenMP/OMPIRBuilder.h</p>
                            </div>
                        </div>
                        <div class="delimiter-container">
                            <div id="EF32BC375E5D760B10BB41A8F0CC89129119E535">
                                <pre><code class="language-cpp code-clang-doc">InsertPoint getPreheaderIP ()</code></pre>
                                <div>
                                    <div>
                                        <p> Return the insertion point for user code before the loop.</p>
                                    </div>
                                </div>
                                <p>Defined at line 3994 of file llvm/include/llvm/Frontend/OpenMP/OMPIRBuilder.h</p>
                            </div>
                        </div>
                        <div class="delimiter-container">
                            <div id="49BFD0F8227C061EF4CE030070A1F8B8BFC4218C">
                                <pre><code class="language-cpp code-clang-doc">InsertPoint getBodyIP ()</code></pre>
                                <div>
                                    <div>
                                        <p> Return the insertion point for user code in the body.</p>
                                    </div>
                                </div>
                                <p>Defined at line 4001 of file llvm/include/llvm/Frontend/OpenMP/OMPIRBuilder.h</p>
                            </div>
                        </div>
                        <div class="delimiter-container">
                            <div id="BD149F584BBDD067E975A2F56877217DF94E8696">
                                <pre><code class="language-cpp code-clang-doc">InsertPoint getAfterIP ()</code></pre>
                                <div>
                                    <div>
                                        <p> Return the insertion point for user code after the loop.</p>
                                    </div>
                                </div>
                                <p>Defined at line 4008 of file llvm/include/llvm/Frontend/OpenMP/OMPIRBuilder.h</p>
                            </div>
                        </div>
                        <div class="delimiter-container">
                            <div id="FAC59110E0D66EACF22323E60637EAABDE3BE2E6">
                                <pre><code class="language-cpp code-clang-doc">Function * getFunction ()</code></pre>
                                <p>Defined at line 4014 of file llvm/include/llvm/Frontend/OpenMP/OMPIRBuilder.h</p>
                            </div>
                        </div>
                        <div class="delimiter-container">
                            <div id="DB5E5358E0B8073FD8DE1042369783C64FEE7572">
                                <pre><code class="language-cpp code-clang-doc">BasicBlock * getPreheader ()</code></pre>
                                <div>
                                    <div>
                                        <p> The preheader ensures that there is only a single edge entering the loop.</p>
                                        <p> Code that must be execute before any loop iteration can be emitted here,</p>
                                        <p> such as computing the loop trip count and begin lifetime markers. Code in</p>
                                        <p> the preheader is not considered part of the canonical loop.</p>
                                    </div>
                                </div>
                                <p>Defined at line 11088 of file llvm/lib/Frontend/OpenMP/OMPIRBuilder.cpp</p>
                            </div>
                        </div>
                        <div class="delimiter-container">
                            <div id="FD6CF901EA2EC1C80719D059EB0C02AFC87550B9">
                                <pre><code class="language-cpp code-clang-doc">void assertOK ()</code></pre>
                                <div>
                                    <div>
                                        <p> Consistency self-check.</p>
                                    </div>
                                </div>
                                <p>Defined at line 11142 of file llvm/lib/Frontend/OpenMP/OMPIRBuilder.cpp</p>
                            </div>
                        </div>
                        <div class="delimiter-container">
                            <div id="C6E3BE002F2FB9CA734626946B68E1A7469EBB48">
                                <pre><code class="language-cpp code-clang-doc">void invalidate ()</code></pre>
                                <div>
                                    <div>
                                        <p> Invalidate this loop. That is, the underlying IR does not fulfill the</p>
                                        <p> requirements of an OpenMP canonical loop anymore.</p>
                                    </div>
                                </div>
                                <p>Defined at line 11236 of file llvm/lib/Frontend/OpenMP/OMPIRBuilder.cpp</p>
                            </div>
                        </div>
                    </div>
                </section>
            </div>
        </div>
    </main>
</body>
</html>

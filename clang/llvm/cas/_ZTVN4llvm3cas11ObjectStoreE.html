<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset="utf-8"/>
    <title>ObjectStore</title>
        <link rel="stylesheet" type="text/css" href="../../clang-doc-mustache.css"/>
        <script src="../../mustache-index.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/default.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/cpp.min.js"></script>
</head>
<body>
    <nav class="navbar">
        <div class="navbar__container">
            <div class="navbar__logo">
                
            </div>
            <div class="navbar__menu">
                <ul class="navbar__links">
                    <li class="navbar__item">
                        <a href="../../index.html" class="navbar__link">Home</a>
                    </li>
                </ul>
            </div>
            <div class="navbar-breadcrumb-container">
                <div class="navbar-breadcrumb-item"><a href="../../GlobalNamespace/index.html">Global Namespace</a></div>&rarr;
                <div class="navbar-breadcrumb-item"><a href="../index.html">llvm</a></div>&rarr;
                <div class="navbar-breadcrumb-item"><a href="./index.html">cas</a></div>
            </div>
        </div>
    </nav>
    <main>
        <div class="container">
            <div class="sidebar">
                <h2>class ObjectStore</h2>
                <ul>
                    <li class="sidebar-section">
                        <a class="sidebar-item" href="#PublicMethods">Public Method</a>
                    </li>
                    <li>
                        <ul>
                            <li class="sidebar-item-container">
                                <a class="sidebar-item" href="#17149F270E26629FBE4D4D085CB2AA60B7A6A67F">createProxy</a>
                            </li>
                            <li class="sidebar-item-container">
                                <a class="sidebar-item" href="#06835E08C89312076FAA0885B5C481E9622CFA16">createUnknownObjectError</a>
                            </li>
                            <li class="sidebar-item-container">
                                <a class="sidebar-item" href="#59B747294BE662B263FD83898753B08680A0CDEE">getProxy</a>
                            </li>
                            <li class="sidebar-item-container">
                                <a class="sidebar-item" href="#17C88D75A4476FE459EF2DFD31B3B50CAA79C7DF">getProxy</a>
                            </li>
                            <li class="sidebar-item-container">
                                <a class="sidebar-item" href="#2512D84DF8FA02E4D3E4821579E1CB5FBE9925AD">getProxyIfExists</a>
                            </li>
                            <li class="sidebar-item-container">
                                <a class="sidebar-item" href="#9C73D79911E00158ECB9A2180E70BEF290861592">validateTree</a>
                            </li>
                            <li class="sidebar-item-container">
                                <a class="sidebar-item" href="#8BEF1E12526D161D80768BF3190AD283E909E867">importObject</a>
                            </li>
                            <li class="sidebar-item-container">
                                <a class="sidebar-item" href="#2292FE9EAC11CC9FFCC134D43E7E564B9C15365F">dump</a>
                            </li>
                            <li class="sidebar-item-container">
                                <a class="sidebar-item" href="#7DA8A1F7DACCDE08F9F9E1C3875D99F7F3D48BB9">storeFromString</a>
                            </li>
                            <li class="sidebar-item-container">
                                <a class="sidebar-item" href="#459DEC4B151E80E45DFC7DBCDE516245C60AB664">storeFromOpenFile</a>
                            </li>
                            <li class="sidebar-item-container">
                                <a class="sidebar-item" href="#30D8B1D9BD45943BF98FCDA163D9F75DC8D83CB6">readData</a>
                            </li>
                            <li class="sidebar-item-container">
                                <a class="sidebar-item" href="#F687AD77F029423664B41B6455799065E26DFE2A">setSizeLimit</a>
                            </li>
                            <li class="sidebar-item-container">
                                <a class="sidebar-item" href="#A8C0706633A49CDA1851F4DCB3885E2310FFF379">getStorageSize</a>
                            </li>
                            <li class="sidebar-item-container">
                                <a class="sidebar-item" href="#6B155E56F25C11372EE84A110F104F3D3B11A9C9">pruneStorageData</a>
                            </li>
                            <li class="sidebar-item-container">
                                <a class="sidebar-item" href="#91B7D18B7E573C592A32A29C840F7865677DEC57">print</a>
                            </li>
                            <li class="sidebar-item-container">
                                <a class="sidebar-item" href="#6C808837EA9A76382986832FF8126785D52D233A">getContext</a>
                            </li>
                            <li class="sidebar-item-container">
                                <a class="sidebar-item" href="#BB499DDE21E9B88200DFD5BD776C81AACAF195F5">~ObjectStore</a>
                            </li>
                            <li class="sidebar-item-container">
                                <a class="sidebar-item" href="#C6518297E1A94314C8F052B69D6C8215DAC5D751">parseID</a>
                            </li>
                            <li class="sidebar-item-container">
                                <a class="sidebar-item" href="#E750A2D7BFD119097B229EBDD56E21EF216C40C6">store</a>
                            </li>
                            <li class="sidebar-item-container">
                                <a class="sidebar-item" href="#348900E87D69BA3F7D57E08B9EEE72A3C34EDCC2">getID</a>
                            </li>
                            <li class="sidebar-item-container">
                                <a class="sidebar-item" href="#0013FDBF329B0B60EB15D4952A60808BC25AD18D">getReference</a>
                            </li>
                            <li class="sidebar-item-container">
                                <a class="sidebar-item" href="#CF9C19BDA96521589C06642237BC8D44780F0DF1">isMaterialized</a>
                            </li>
                            <li class="sidebar-item-container">
                                <a class="sidebar-item" href="#CD13595792500727A81998819DEEDB6658D5C3AA">validateObject</a>
                            </li>
                            <li class="sidebar-item-container">
                                <a class="sidebar-item" href="#1F70A84C36925E482E4FC5F70F0B98B014B77EAD">validate</a>
                            </li>
                        </ul>
                    </li>
                </ul>
            </div>
            <div class="resizer" id="resizer"></div>
            <div class="content">
                <section class="hero section-container">
                    <div class="hero__title">
                        <h1 class="hero__title-large">class ObjectStore</h1>
                        <p>Defined at line 90 of file llvm/include/llvm/CAS/ObjectStore.h</p>
                        <div class="hero__subtitle">
                            <div>
                                <p> Content-addressable storage for objects.</p>
                            </div>
                            <div>
                                <p> Conceptually, objects are stored in a &quot;unique set&quot;.</p>
                            </div>
                            <div>
                                <p> - Objects are immutable (&quot;value objects&quot;) that are defined by their</p>
                                <p>   content. They are implicitly deduplicated by content.</p>
                                <p> - Each object has a unique identifier (UID) that&#39;s derived from its content,</p>
                                <p>   called a </p>
                                <p>     - This UID is a fixed-size (strong) hash of the transitive content of a</p>
                                <p>       CAS object.</p>
                                <p>     - It&#39;s comparable between any two CAS instances that have the same </p>
                                <p>     - The UID can be printed (e.g., </p>
                                <p> and it can parsed</p>
                                <p>       by the same or a different CAS instance with </p>
                                <p> - An object can be looked up by content or by UID.</p>
                                <p>     - </p>
                                <p> is &quot;get-or-create&quot;  methods, writing an object if it</p>
                                <p>       doesn&#39;t exist yet, and return a ref to it in any case.</p>
                                <p>     - </p>
                                <p> CASID</p>
                                <p>&amp;</p>
                                <p>) looks up an object by its UID.</p>
                                <p> - Objects can reference other objects, forming an arbitrary DAG.</p>
                            </div>
                            <div>
                                <p> The </p>
                                <p> interface has a few ways of referencing objects:</p>
                            </div>
                            <div>
                                <p> - </p>
                                <p> encapsulates a reference to something in the CAS. It is an</p>
                                <p>   opaque type that references an object inside a specific CAS. It is</p>
                                <p>   implementation defined if the underlying object exists or not for an</p>
                                <p>   ObjectRef, and it can used to speed up CAS lookup as an implementation</p>
                                <p>   detail. However, you don&#39;t know anything about the underlying objects.</p>
                                <p>   &quot;Loading&quot; the object is a separate step that may not have happened</p>
                                <p>   yet, and which can fail (e.g. due to filesystem corruption) or introduce</p>
                                <p>   latency (if downloading from a remote store).</p>
                                <p> - </p>
                                <p> encapulates a *loaded* object in the CAS. You need one of</p>
                                <p>   these to inspect the content of an object: to look at its stored</p>
                                <p>   data and references. This is internal to CAS implementation and not</p>
                                <p>   availble from CAS public APIs.</p>
                                <p> - </p>
                                <p> the UID for an object in the CAS, obtained through </p>
                                <p> or </p>
                                <p> This is a valid CAS</p>
                                <p>   identifier, but may reference an object that is unknown to this CAS</p>
                                <p>   instance.</p>
                                <p> - </p>
                                <p> pairs an ObjectHandle (subclass) with a ObjectStore, and</p>
                                <p>   wraps access APIs to avoid having to pass extra parameters. It is the</p>
                                <p>   object used for accessing underlying data and refs by CAS users.</p>
                            </div>
                            <div>
                                <p> Both ObjectRef and ObjectHandle are lightweight, wrapping a `uint64_t` and</p>
                                <p> are only valid with the associated ObjectStore instance.</p>
                            </div>
                            <div>
                                <p> There are a few options for accessing content of objects, with different</p>
                                <p> lifetime tradeoffs:</p>
                            </div>
                            <div>
                                <p> - </p>
                                <p> accesses data without exposing lifetime at all.</p>
                                <p> - </p>
                                <p> returns a </p>
                                <p> whose lifetime</p>
                                <p>   is independent of the CAS (it can live longer).</p>
                                <p> - </p>
                                <p> return StringRef with lifetime is guaranteed to last as</p>
                                <p>   long as </p>
                                <p> - </p>
                                <p> and </p>
                                <p> iterate through the references in an</p>
                                <p>   object. There is no lifetime assumption.</p>
                            </div>
                        </div>
                    </div>
                </section>
                <section id="PublicMethods" class="section-container">
                    <h2>Public Methods</h2>
                    <div>
                        <div class="delimiter-container">
                            <div id="17149F270E26629FBE4D4D085CB2AA60B7A6A67F">
                                <pre><code class="language-cpp code-clang-doc">Expected&lt;ObjectProxy&gt; createProxy (ArrayRef Refs, StringRef Data)</code></pre>
                                <div>
                                    <div>
                                        <p> Helper functions to store object and returns a ObjectProxy.</p>
                                    </div>
                                </div>
                                <p>Defined at line 114 of file llvm/lib/CAS/ObjectStore.cpp</p>
                            </div>
                        </div>
                        <div class="delimiter-container">
                            <div id="06835E08C89312076FAA0885B5C481E9622CFA16">
                                <pre><code class="language-cpp code-clang-doc">Error createUnknownObjectError (const CASID &amp; ID)</code></pre>
                                <p>Defined at line 109 of file llvm/lib/CAS/ObjectStore.cpp</p>
                            </div>
                        </div>
                        <div class="delimiter-container">
                            <div id="59B747294BE662B263FD83898753B08680A0CDEE">
                                <pre><code class="language-cpp code-clang-doc">Expected&lt;ObjectProxy&gt; getProxy (const CASID &amp; ID)</code></pre>
                                <div>
                                    <div>
                                        <p> Create ObjectProxy from CASID. If the object doesn&#39;t exist, get an error.</p>
                                    </div>
                                </div>
                                <p>Defined at line 83 of file llvm/lib/CAS/ObjectStore.cpp</p>
                            </div>
                        </div>
                        <div class="delimiter-container">
                            <div id="17C88D75A4476FE459EF2DFD31B3B50CAA79C7DF">
                                <pre><code class="language-cpp code-clang-doc">Expected&lt;ObjectProxy&gt; getProxy (ObjectRef Ref)</code></pre>
                                <div>
                                    <div>
                                        <p> Create ObjectProxy from ObjectRef. If the object can&#39;t be loaded, get an</p>
                                        <p> error.</p>
                                    </div>
                                </div>
                                <p>Defined at line 91 of file llvm/lib/CAS/ObjectStore.cpp</p>
                            </div>
                        </div>
                        <div class="delimiter-container">
                            <div id="2512D84DF8FA02E4D3E4821579E1CB5FBE9925AD">
                                <pre><code class="language-cpp code-clang-doc">Expected&lt;std::optional&lt;ObjectProxy&gt;&gt; getProxyIfExists (ObjectRef Ref)</code></pre>
                                <div>
                                </div>
                                <p>Defined at line 99 of file llvm/lib/CAS/ObjectStore.cpp</p>
                            </div>
                        </div>
                        <div class="delimiter-container">
                            <div id="9C73D79911E00158ECB9A2180E70BEF290861592">
                                <pre><code class="language-cpp code-clang-doc">Error validateTree (ObjectRef Ref)</code></pre>
                                <div>
                                    <div>
                                        <p> Validate the whole node tree.</p>
                                    </div>
                                </div>
                                <p>Defined at line 135 of file llvm/lib/CAS/ObjectStore.cpp</p>
                            </div>
                        </div>
                        <div class="delimiter-container">
                            <div id="8BEF1E12526D161D80768BF3190AD283E909E867">
                                <pre><code class="language-cpp code-clang-doc">Expected importObject (ObjectStore &amp; Upstream, ObjectRef Other)</code></pre>
                                <div>
                                    <div>
                                        <p> Import object from another CAS. This will import the full tree from the</p>
                                        <p> other CAS.</p>
                                    </div>
                                </div>
                                <p>Defined at line 159 of file llvm/lib/CAS/ObjectStore.cpp</p>
                            </div>
                        </div>
                        <div class="delimiter-container">
                            <div id="2292FE9EAC11CC9FFCC134D43E7E564B9C15365F">
                                <pre><code class="language-cpp code-clang-doc">void dump ()</code></pre>
                                <p>Defined at line 24 of file llvm/lib/CAS/ObjectStore.cpp</p>
                            </div>
                        </div>
                        <div class="delimiter-container">
                            <div id="7DA8A1F7DACCDE08F9F9E1C3875D99F7F3D48BB9">
                                <pre><code class="language-cpp code-clang-doc">Expected storeFromString (ArrayRef Refs, StringRef String)</code></pre>
                                <div>
                                    <div>
                                        <p> Store object from StringRef.</p>
                                    </div>
                                </div>
                                <p>Defined at line 186 of file llvm/include/llvm/CAS/ObjectStore.h</p>
                            </div>
                        </div>
                        <div class="delimiter-container">
                            <div id="459DEC4B151E80E45DFC7DBCDE516245C60AB664">
                                <pre><code class="language-cpp code-clang-doc">Expected storeFromOpenFile (sys::fs::file_t FD, optional Status)</code></pre>
                                <div>
                                    <div>
                                        <p> Default implementation reads </p>
                                        <p> and calls </p>
                                        <p> Does not</p>
                                        <p> take ownership of </p>
                                        <p> the caller is responsible for closing it.</p>
                                    </div>
                                    <div>
                                        <p> If </p>
                                        <p> is sent in it is to be treated as a hint. Implementations</p>
                                        <p> must protect against the file size potentially growing after the status</p>
                                        <p> was taken (i.e., they cannot assume that an mmap will be null-terminated</p>
                                        <p> where </p>
                                        <p> implies).</p>
                                    </div>
                                    <div>
                                        <p> Returns the </p>
                                        <p> and the size of the file.</p>
                                    </div>
                                </div>
                                <p>Defined at line 200 of file llvm/include/llvm/CAS/ObjectStore.h</p>
                            </div>
                        </div>
                        <div class="delimiter-container">
                            <div id="30D8B1D9BD45943BF98FCDA163D9F75DC8D83CB6">
                                <pre><code class="language-cpp code-clang-doc">uint64_t readData (ObjectHandle Node, raw_ostream &amp; OS, uint64_t Offset, uint64_t MaxBytes)</code></pre>
                                <div>
                                    <div>
                                        <p> Read the data from </p>
                                        <p> into </p>
                                    </div>
                                </div>
                                <p>Defined at line 218 of file llvm/include/llvm/CAS/ObjectStore.h</p>
                            </div>
                        </div>
                        <div class="delimiter-container">
                            <div id="F687AD77F029423664B41B6455799065E26DFE2A">
                                <pre><code class="language-cpp code-clang-doc">Error setSizeLimit (optional SizeLimit)</code></pre>
                                <div>
                                    <div>
                                        <p> Set the size for limiting growth of on-disk storage. This has an effect</p>
                                        <p> for when the instance is closed.</p>
                                    </div>
                                    <div>
                                        <p> Implementations may leave this unimplemented.</p>
                                    </div>
                                </div>
                                <p>Defined at line 231 of file llvm/include/llvm/CAS/ObjectStore.h</p>
                            </div>
                        </div>
                        <div class="delimiter-container">
                            <div id="A8C0706633A49CDA1851F4DCB3885E2310FFF379">
                                <pre><code class="language-cpp code-clang-doc">Expected getStorageSize ()</code></pre>
                                <div>
                                    <div>
                                        <p> Implementations that don&#39;t have an implementation for this should return</p>
                                    </div>
                                </div>
                                <p>Defined at line 239 of file llvm/include/llvm/CAS/ObjectStore.h</p>
                            </div>
                        </div>
                        <div class="delimiter-container">
                            <div id="6B155E56F25C11372EE84A110F104F3D3B11A9C9">
                                <pre><code class="language-cpp code-clang-doc">Error pruneStorageData ()</code></pre>
                                <div>
                                    <div>
                                        <p> Prune local storage to reduce its size according to the desired size</p>
                                        <p> limit. Pruning can happen concurrently with other operations.</p>
                                    </div>
                                    <div>
                                        <p> Implementations may leave this unimplemented.</p>
                                    </div>
                                </div>
                                <p>Defined at line 247 of file llvm/include/llvm/CAS/ObjectStore.h</p>
                            </div>
                        </div>
                        <div class="delimiter-container">
                            <div id="91B7D18B7E573C592A32A29C840F7865677DEC57">
                                <pre><code class="language-cpp code-clang-doc">void print (raw_ostream &amp; )</code></pre>
                                <div>
                                    <div>
                                        <p> Print the ObjectStore internals for debugging purpose.</p>
                                    </div>
                                </div>
                                <p>Defined at line 258 of file llvm/include/llvm/CAS/ObjectStore.h</p>
                            </div>
                        </div>
                        <div class="delimiter-container">
                            <div id="6C808837EA9A76382986832FF8126785D52D233A">
                                <pre><code class="language-cpp code-clang-doc">const CASContext &amp; getContext ()</code></pre>
                                <div>
                                    <div>
                                        <p> Get CASContext</p>
                                    </div>
                                </div>
                                <p>Defined at line 262 of file llvm/include/llvm/CAS/ObjectStore.h</p>
                            </div>
                        </div>
                        <div class="delimiter-container">
                            <div id="BB499DDE21E9B88200DFD5BD776C81AACAF195F5">
                                <pre><code class="language-cpp code-clang-doc">void ~ObjectStore ()</code></pre>
                                <p>Defined at line 264 of file llvm/include/llvm/CAS/ObjectStore.h</p>
                            </div>
                        </div>
                        <div class="delimiter-container">
                            <div id="C6518297E1A94314C8F052B69D6C8215DAC5D751">
                                <pre><code class="language-cpp code-clang-doc">Expected&lt;CASID&gt; parseID (StringRef ID)</code></pre>
                                <div>
                                    <div>
                                        <p> Get a </p>
                                        <p> from a </p>
                                        <p> which should have been generated by </p>
                                        <p> This succeeds as long as </p>
                                        <p> would pass. The</p>
                                        <p> object may be unknown to this CAS instance.</p>
                                    </div>
                                    <div>
                                        <p> TODO: Remove, and update callers to use </p>
                                        <p> or </p>
                                    </div>
                                </div>
                                <p>Defined at line  of file </p>
                            </div>
                        </div>
                        <div class="delimiter-container">
                            <div id="E750A2D7BFD119097B229EBDD56E21EF216C40C6">
                                <pre><code class="language-cpp code-clang-doc">Expected store (ArrayRef Refs, ArrayRef Data)</code></pre>
                                <div>
                                    <div>
                                        <p> Store object into ObjectStore.</p>
                                    </div>
                                </div>
                                <p>Defined at line  of file </p>
                            </div>
                        </div>
                        <div class="delimiter-container">
                            <div id="348900E87D69BA3F7D57E08B9EEE72A3C34EDCC2">
                                <pre><code class="language-cpp code-clang-doc">CASID getID (ObjectRef Ref)</code></pre>
                                <div>
                                    <div>
                                        <p> Get an ID for </p>
                                    </div>
                                </div>
                                <p>Defined at line  of file </p>
                            </div>
                        </div>
                        <div class="delimiter-container">
                            <div id="0013FDBF329B0B60EB15D4952A60808BC25AD18D">
                                <pre><code class="language-cpp code-clang-doc">std::optional&lt;ObjectRef&gt; getReference (const CASID &amp; ID)</code></pre>
                                <div>
                                    <div>
                                        <p> Get an existing reference to the object called </p>
                                    </div>
                                    <div>
                                        <p> Returns </p>
                                        <p> if the object is not stored in this CAS.</p>
                                    </div>
                                </div>
                                <p>Defined at line  of file </p>
                            </div>
                        </div>
                        <div class="delimiter-container">
                            <div id="CF9C19BDA96521589C06642237BC8D44780F0DF1">
                                <pre><code class="language-cpp code-clang-doc">Expected&lt;bool&gt; isMaterialized (ObjectRef Ref)</code></pre>
                                <div>
                                </div>
                                <p>Defined at line  of file </p>
                            </div>
                        </div>
                        <div class="delimiter-container">
                            <div id="CD13595792500727A81998819DEEDB6658D5C3AA">
                                <pre><code class="language-cpp code-clang-doc">Error validateObject (const CASID &amp; ID)</code></pre>
                                <div>
                                    <div>
                                        <p> Validate the underlying object referred by CASID.</p>
                                    </div>
                                </div>
                                <p>Defined at line  of file </p>
                            </div>
                        </div>
                        <div class="delimiter-container">
                            <div id="1F70A84C36925E482E4FC5F70F0B98B014B77EAD">
                                <pre><code class="language-cpp code-clang-doc">Error validate (bool CheckHash)</code></pre>
                                <div>
                                    <div>
                                        <p> Validate the entire ObjectStore.</p>
                                    </div>
                                </div>
                                <p>Defined at line  of file </p>
                            </div>
                        </div>
                    </div>
                </section>
            </div>
        </div>
    </main>
</body>
</html>

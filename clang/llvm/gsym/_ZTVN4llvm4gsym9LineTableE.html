<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset="utf-8"/>
    <title>LineTable</title>
        <link rel="stylesheet" type="text/css" href="../../clang-doc-mustache.css"/>
        <script src="../../mustache-index.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/default.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/cpp.min.js"></script>
</head>
<body>
    <nav class="navbar">
        <div class="navbar__container">
            <div class="navbar__logo">
                
            </div>
            <div class="navbar__menu">
                <ul class="navbar__links">
                    <li class="navbar__item">
                        <a href="../../index.html" class="navbar__link">Home</a>
                    </li>
                </ul>
            </div>
            <div class="navbar-breadcrumb-container">
                <div class="navbar-breadcrumb-item"><a href="../../GlobalNamespace/index.html">Global Namespace</a></div>&rarr;
                <div class="navbar-breadcrumb-item"><a href="../index.html">llvm</a></div>&rarr;
                <div class="navbar-breadcrumb-item"><a href="./index.html">gsym</a></div>
            </div>
        </div>
    </nav>
    <main>
        <div class="container">
            <div class="sidebar">
                <h2>class LineTable</h2>
                <ul>
                    <li class="sidebar-section">
                        <a class="sidebar-item" href="#PublicMethods">Public Method</a>
                    </li>
                    <li>
                        <ul>
                            <li class="sidebar-item-container">
                                <a class="sidebar-item" href="#D8DB7EE32AD0F325E23188616C4DBDD69EF3017C">encode</a>
                            </li>
                            <li class="sidebar-item-container">
                                <a class="sidebar-item" href="#DC390DCBAA9C95FED9FEFF8E5F866E7CD97523FA">empty</a>
                            </li>
                            <li class="sidebar-item-container">
                                <a class="sidebar-item" href="#390238E2B0D979FE511A5C3824CAF5C3A0D94BE7">clear</a>
                            </li>
                            <li class="sidebar-item-container">
                                <a class="sidebar-item" href="#A6A952679B263ECCED3CAC9F6E1A73BB30ED44E8">first</a>
                            </li>
                            <li class="sidebar-item-container">
                                <a class="sidebar-item" href="#7546A348BEB775D34D14B9CEA0B19E129AECA733">last</a>
                            </li>
                            <li class="sidebar-item-container">
                                <a class="sidebar-item" href="#A79830E54538FEC5B046D01618FBE98486509EB4">push</a>
                            </li>
                            <li class="sidebar-item-container">
                                <a class="sidebar-item" href="#EF0979679A3317A724E64A25A1A2442B24617D53">isValid</a>
                            </li>
                            <li class="sidebar-item-container">
                                <a class="sidebar-item" href="#1ED79DE142200CE438DD6006D8A103355B990D46">size</a>
                            </li>
                            <li class="sidebar-item-container">
                                <a class="sidebar-item" href="#174752EAA2CE60498E4A7AF4889608960B7F7FB1">get</a>
                            </li>
                            <li class="sidebar-item-container">
                                <a class="sidebar-item" href="#25ACED1E9FDE1C3B6D70AF9E683B77E39E31B916">get</a>
                            </li>
                            <li class="sidebar-item-container">
                                <a class="sidebar-item" href="#D6823ABDD9FDC1A2F23D9109C4268FB7C50D277C">operator[]</a>
                            </li>
                            <li class="sidebar-item-container">
                                <a class="sidebar-item" href="#9D5767DB4A67521F2555A5560D83B1565773AB4E">operator[]</a>
                            </li>
                            <li class="sidebar-item-container">
                                <a class="sidebar-item" href="#22CCBBC38B7802EF58A3E6EF40E59C672D0B40F9">operator==</a>
                            </li>
                            <li class="sidebar-item-container">
                                <a class="sidebar-item" href="#9CA50AFC91AFC8EB8BE226D2C510AECCC92B14D7">operator!=</a>
                            </li>
                            <li class="sidebar-item-container">
                                <a class="sidebar-item" href="#B7FA2F64BDC80FBCB2A05BA2BBB6D12D74BB7F99">operator&lt;</a>
                            </li>
                            <li class="sidebar-item-container">
                                <a class="sidebar-item" href="#DF89F41E9DB13589A109436321CB395BBF69C124">begin</a>
                            </li>
                            <li class="sidebar-item-container">
                                <a class="sidebar-item" href="#A36F7F3D71FFB7DB06086A6537F9B4E3E0741BBD">end</a>
                            </li>
                            <li class="sidebar-item-container">
                                <a class="sidebar-item" href="#7664BFDDE98BB4EBCB8C158329E99B09EDA37898">lookup</a>
                            </li>
                            <li class="sidebar-item-container">
                                <a class="sidebar-item" href="#5CD1EC5CFA45C493443DB6C98116D6142422F8F2">decode</a>
                            </li>
                        </ul>
                    </li>
                </ul>
            </div>
            <div class="resizer" id="resizer"></div>
            <div class="content">
                <section class="hero section-container">
                    <div class="hero__title">
                        <h1 class="hero__title-large">class LineTable</h1>
                        <p>Defined at line 119 of file llvm/include/llvm/DebugInfo/GSYM/LineTable.h</p>
                        <div class="hero__subtitle">
                            <div>
                                <p> LineTable class contains deserialized versions of line tables for each</p>
                                <p> function&#39;s address ranges.</p>
                            </div>
                            <div>
                                <p> When saved to disk, the line table is encoded using a modified version of</p>
                                <p> the DWARF line tables that only tracks address to source file and line.</p>
                            </div>
                            <div>
                                <p> ENCODING</p>
                            </div>
                            <div>
                                <p> The line table starts with a small prolog that contains the following</p>
                                <p> values:</p>
                            </div>
                            <div>
                                <p> ENCODING NAME        DESCRIPTION</p>
                                <p> ======== =========== ====================================================</p>
                                <p> SLEB     MinDelta    The min line delta for special opcodes that  advance</p>
                                <p>                      the address and line number.</p>
                                <p> SLEB     MaxDelta    The max line delta for single byte opcodes that</p>
                                <p>                      advance the address and line number.</p>
                                <p> ULEB     FirstLine   The value of the first source line number to</p>
                                <p>                      initialize the LineEntry with.</p>
                            </div>
                            <div>
                                <p> Once these prolog items are read, we initialize a LineEntry struct with</p>
                                <p> the start address of the function from the FunctionInfo&#39;s address range,</p>
                                <p> a default file index of 1, and the line number set to &quot;FirstLine&quot; from</p>
                                <p> the prolog above:</p>
                            </div>
                            <div>
                                <p>   LineEntry Row(BaseAddr, 1, FirstLine);</p>
                            </div>
                            <div>
                                <p> The line table state machine is now initialized and ready to be parsed.</p>
                                <p> The stream that follows this encodes the line entries in a compact</p>
                                <p> form. Some opcodes cause &quot;Row&quot; to be modified and some opcodes may also</p>
                                <p> push &quot;Row&quot; onto the end of the &quot;LineTable.Lines&quot; vector. The end result</p>
                                <p> is a vector of LineEntry structs that is sorted in ascending address</p>
                                <p> order.</p>
                            </div>
                            <div>
                                <p> NORMAL OPCODES</p>
                            </div>
                            <div>
                                <p> The opcodes 0 through 3 are normal in opcodes. Their encoding and</p>
                                <p> descriptions are listed below:</p>
                            </div>
                            <div>
                                <p> ENCODING ENUMERATION       VALUE DESCRIPTION</p>
                                <p> ======== ================  ===== ========================================</p>
                                <p>          LTOC_EndSequence  0x00  Parsing is done.</p>
                                <p> ULEB     LTOC_SetFile      0x01  Row.File = ULEB</p>
                                <p> ULEB     LTOC_AdvancePC    0x02  Row.Addr += ULEB, push &quot;Row&quot;.</p>
                                <p> SLEB     LTOC_AdvanceLine  0x03  Row.Line += SLEB</p>
                                <p>          LTOC_FirstSpecial 0x04  First special opcode (see SPECIAL</p>
                                <p>                                  OPCODES below).</p>
                            </div>
                            <div>
                                <p> SPECIAL OPCODES</p>
                            </div>
                            <div>
                                <p> Opcodes LTOC_FirstSpecial through 255 are special opcodes that always</p>
                                <p> increment both the Row.Addr and Row.Line and push &quot;Row&quot; onto the</p>
                                <p> LineEntry.Lines array. They do this by using some of the bits to</p>
                                <p> increment/decrement the source line number, and some of the bits to</p>
                                <p> increment the address. Line numbers can go up or down when making line</p>
                                <p> tables, where addresses always only increase since line tables are sorted</p>
                                <p> by address.</p>
                            </div>
                            <div>
                                <p> In order to calculate the amount to increment the line and address for</p>
                                <p> these special opcodes, we calculate the number of values reserved for the</p>
                                <p> line increment/decrement using the &quot;MinDelta&quot; and &quot;MaxDelta&quot; from the</p>
                                <p> prolog:</p>
                            </div>
                            <div>
                                <p>     const int64_t LineRange = MaxDelta - MinDelta + 1;</p>
                            </div>
                            <div>
                                <p> Then we can adjust the opcode to not include any of the normal opcodes:</p>
                            </div>
                            <div>
                                <p>     const uint8_t AdjustedOp = Opcode - LTOC_FirstSpecial;</p>
                            </div>
                            <div>
                                <p> And we can calculate the line offset, and address offset:</p>
                            </div>
                            <div>
                                <p>     const int64_t LineDelta = MinDelta + (AdjustedOp % LineRange);</p>
                                <p>     const uint64_t AddrDelta = (AdjustedOp / LineRange);</p>
                            </div>
                            <div>
                                <p> And use these to modify our &quot;Row&quot;:</p>
                            </div>
                            <div>
                                <p>     Row.Line += LineDelta;</p>
                                <p>     Row.Addr += AddrDelta;</p>
                            </div>
                            <div>
                                <p> And push a row onto the line table:</p>
                            </div>
                            <div>
                                <p>     Lines.push_back(Row);</p>
                            </div>
                            <div>
                                <p> This is verify similar to the way that DWARF encodes its line tables. The</p>
                                <p> only difference is the DWARF line tables have more normal opcodes and the</p>
                                <p> &quot;Row&quot; contains more members, like source column number, bools for end of</p>
                                <p> prologue, beginnging of epilogue, is statement and many others. There are</p>
                                <p> also more complex rules that happen for the extra normal opcodes. By</p>
                                <p> leaving these extra opcodes out, we leave more bits for the special</p>
                                <p> opcodes that allows us to encode line tables in fewer bytes than standard</p>
                                <p> DWARF encodings.</p>
                            </div>
                            <div>
                                <p> Opcodes that will push &quot;Row&quot; onto the LineEntry.Lines include the</p>
                                <p> LTOC_AdvancePC opcode and all special opcodes. All other opcodes</p>
                                <p> only modify the current &quot;Row&quot;, or cause the line table to end.</p>
                            </div>
                        </div>
                    </div>
                </section>
                <section id="PublicMethods" class="section-container">
                    <h2>Public Methods</h2>
                    <div>
                        <div class="delimiter-container">
                            <div id="D8DB7EE32AD0F325E23188616C4DBDD69EF3017C">
                                <pre><code class="language-cpp code-clang-doc">Error encode (FileWriter &amp; O, uint64_t BaseAddr)</code></pre>
                                <div>
                                    <div>
                                        <p> Encode this LineTable object into FileWriter stream.</p>
                                    </div>
                                    <h3>Parameters</h3>
                                    <div>
                                        <b>O</b>   The binary stream to write the data to at the current file position.
                                    </div> 
                                    <div>
                                        <b>BaseAddr</b>   The base address to use when decoding the line table. This will be the FunctionInfo&#39;s start address.
                                    </div> 
                                </div>
                                <p>Defined at line 122 of file llvm/lib/DebugInfo/GSYM/LineTable.cpp</p>
                            </div>
                        </div>
                        <div class="delimiter-container">
                            <div id="DC390DCBAA9C95FED9FEFF8E5F866E7CD97523FA">
                                <pre><code class="language-cpp code-clang-doc">bool empty ()</code></pre>
                                <p>Defined at line 168 of file llvm/include/llvm/DebugInfo/GSYM/LineTable.h</p>
                            </div>
                        </div>
                        <div class="delimiter-container">
                            <div id="390238E2B0D979FE511A5C3824CAF5C3A0D94BE7">
                                <pre><code class="language-cpp code-clang-doc">void clear ()</code></pre>
                                <p>Defined at line 169 of file llvm/include/llvm/DebugInfo/GSYM/LineTable.h</p>
                            </div>
                        </div>
                        <div class="delimiter-container">
                            <div id="A6A952679B263ECCED3CAC9F6E1A73BB30ED44E8">
                                <pre><code class="language-cpp code-clang-doc">optional first ()</code></pre>
                                <div>
                                    <div>
                                        <p> Return the first line entry if the line table isn&#39;t empty.</p>
                                    </div>
                                </div>
                                <p>Defined at line 174 of file llvm/include/llvm/DebugInfo/GSYM/LineTable.h</p>
                            </div>
                        </div>
                        <div class="delimiter-container">
                            <div id="7546A348BEB775D34D14B9CEA0B19E129AECA733">
                                <pre><code class="language-cpp code-clang-doc">optional last ()</code></pre>
                                <div>
                                    <div>
                                        <p> Return the last line entry if the line table isn&#39;t empty.</p>
                                    </div>
                                </div>
                                <p>Defined at line 183 of file llvm/include/llvm/DebugInfo/GSYM/LineTable.h</p>
                            </div>
                        </div>
                        <div class="delimiter-container">
                            <div id="A79830E54538FEC5B046D01618FBE98486509EB4">
                                <pre><code class="language-cpp code-clang-doc">void push (const LineEntry &amp; LE)</code></pre>
                                <p>Defined at line 188 of file llvm/include/llvm/DebugInfo/GSYM/LineTable.h</p>
                            </div>
                        </div>
                        <div class="delimiter-container">
                            <div id="EF0979679A3317A724E64A25A1A2442B24617D53">
                                <pre><code class="language-cpp code-clang-doc">size_t isValid ()</code></pre>
                                <p>Defined at line 191 of file llvm/include/llvm/DebugInfo/GSYM/LineTable.h</p>
                            </div>
                        </div>
                        <div class="delimiter-container">
                            <div id="1ED79DE142200CE438DD6006D8A103355B990D46">
                                <pre><code class="language-cpp code-clang-doc">size_t size ()</code></pre>
                                <p>Defined at line 194 of file llvm/include/llvm/DebugInfo/GSYM/LineTable.h</p>
                            </div>
                        </div>
                        <div class="delimiter-container">
                            <div id="174752EAA2CE60498E4A7AF4889608960B7F7FB1">
                                <pre><code class="language-cpp code-clang-doc">LineEntry &amp; get (size_t i)</code></pre>
                                <p>Defined at line 197 of file llvm/include/llvm/DebugInfo/GSYM/LineTable.h</p>
                            </div>
                        </div>
                        <div class="delimiter-container">
                            <div id="25ACED1E9FDE1C3B6D70AF9E683B77E39E31B916">
                                <pre><code class="language-cpp code-clang-doc">const LineEntry &amp; get (size_t i)</code></pre>
                                <p>Defined at line 201 of file llvm/include/llvm/DebugInfo/GSYM/LineTable.h</p>
                            </div>
                        </div>
                        <div class="delimiter-container">
                            <div id="D6823ABDD9FDC1A2F23D9109C4268FB7C50D277C">
                                <pre><code class="language-cpp code-clang-doc">LineEntry &amp; operator[] (size_t i)</code></pre>
                                <p>Defined at line 205 of file llvm/include/llvm/DebugInfo/GSYM/LineTable.h</p>
                            </div>
                        </div>
                        <div class="delimiter-container">
                            <div id="9D5767DB4A67521F2555A5560D83B1565773AB4E">
                                <pre><code class="language-cpp code-clang-doc">const LineEntry &amp; operator[] (size_t i)</code></pre>
                                <p>Defined at line 208 of file llvm/include/llvm/DebugInfo/GSYM/LineTable.h</p>
                            </div>
                        </div>
                        <div class="delimiter-container">
                            <div id="22CCBBC38B7802EF58A3E6EF40E59C672D0B40F9">
                                <pre><code class="language-cpp code-clang-doc">bool operator== (const LineTable &amp; RHS)</code></pre>
                                <p>Defined at line 211 of file llvm/include/llvm/DebugInfo/GSYM/LineTable.h</p>
                            </div>
                        </div>
                        <div class="delimiter-container">
                            <div id="9CA50AFC91AFC8EB8BE226D2C510AECCC92B14D7">
                                <pre><code class="language-cpp code-clang-doc">bool operator!= (const LineTable &amp; RHS)</code></pre>
                                <p>Defined at line 214 of file llvm/include/llvm/DebugInfo/GSYM/LineTable.h</p>
                            </div>
                        </div>
                        <div class="delimiter-container">
                            <div id="B7FA2F64BDC80FBCB2A05BA2BBB6D12D74BB7F99">
                                <pre><code class="language-cpp code-clang-doc">bool operator&lt; (const LineTable &amp; RHS)</code></pre>
                                <p>Defined at line 217 of file llvm/include/llvm/DebugInfo/GSYM/LineTable.h</p>
                            </div>
                        </div>
                        <div class="delimiter-container">
                            <div id="DF89F41E9DB13589A109436321CB395BBF69C124">
                                <pre><code class="language-cpp code-clang-doc">__normal_iterator begin ()</code></pre>
                                <p>Defined at line 224 of file llvm/include/llvm/DebugInfo/GSYM/LineTable.h</p>
                            </div>
                        </div>
                        <div class="delimiter-container">
                            <div id="A36F7F3D71FFB7DB06086A6537F9B4E3E0741BBD">
                                <pre><code class="language-cpp code-clang-doc">__normal_iterator end ()</code></pre>
                                <p>Defined at line 225 of file llvm/include/llvm/DebugInfo/GSYM/LineTable.h</p>
                            </div>
                        </div>
                        <div class="delimiter-container">
                            <div id="7664BFDDE98BB4EBCB8C158329E99B09EDA37898">
                                <pre><code class="language-cpp code-clang-doc">Expected&lt;LineEntry&gt; lookup (DataExtractor &amp; Data, uint64_t BaseAddr, uint64_t Addr)</code></pre>
                                <div>
                                    <div>
                                        <p> Lookup a single address within a line table&#39;s data.</p>
                                    </div>
                                    <div>
                                        <p> Clients have the option to decode an entire line table using</p>
                                        <p> LineTable::decode() or just find a single matching entry using this</p>
                                        <p> function. The benefit of using this function is that parsed LineEntry</p>
                                        <p> objects that do not match will not be stored in an array. This will avoid</p>
                                        <p> memory allocation costs and parsing can stop once a match has been found.</p>
                                    </div>
                                    <h3>Parameters</h3>
                                    <div>
                                        <b>Data</b>   The binary stream to read the data from. This object must have the data for the LineTable object starting at offset zero. The data can contain more data than needed.
                                    </div> 
                                    <div>
                                        <b>BaseAddr</b>   The base address to use when decoding the line table. This will be the FunctionInfo&#39;s start address and will be used to initialize the line table row prior to parsing any opcodes.
                                    </div> 
                                </div>
                                <p>Defined at line 266 of file llvm/lib/DebugInfo/GSYM/LineTable.cpp</p>
                            </div>
                        </div>
                        <div class="delimiter-container">
                            <div id="5CD1EC5CFA45C493443DB6C98116D6142422F8F2">
                                <pre><code class="language-cpp code-clang-doc">llvm::Expected&lt;LineTable&gt; decode (DataExtractor &amp; Data, uint64_t BaseAddr)</code></pre>
                                <div>
                                    <div>
                                        <p> Decode an LineTable object from a binary data stream.</p>
                                    </div>
                                    <h3>Parameters</h3>
                                    <div>
                                        <b>Data</b>   The binary stream to read the data from. This object must have the data for the LineTable object starting at offset zero. The data can contain more data than needed.
                                    </div> 
                                    <div>
                                        <b>BaseAddr</b>   The base address to use when decoding the line table. This will be the FunctionInfo&#39;s start address and will be used to initialize the line table row prior to parsing any opcodes.
                                    </div> 
                                </div>
                                <p>Defined at line 251 of file llvm/lib/DebugInfo/GSYM/LineTable.cpp</p>
                            </div>
                        </div>
                    </div>
                </section>
            </div>
        </div>
    </main>
</body>
</html>
